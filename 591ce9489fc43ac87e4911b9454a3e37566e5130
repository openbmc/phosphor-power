{
  "comments": [
    {
      "key": {
        "uuid": "4588b482_5de63a3c",
        "filename": "meson.build",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1000331
      },
      "writtenOn": "2021-06-28T18:54:30Z",
      "side": 1,
      "message": "The advantage of this approach is that the generic PSU type could map to multiple config file variables.  The disadvantage is that if someone has a non-IBM PSU, they need to modify this file to add support for it.\n\nAn alternative approach would be a power_supply_interface build option that is set directly to the D-Bus interface name.  For example, -Dpower_supply_interface\u003dxyz.openbmc_project.Acme.PSU.  Then no changes are required to this file for non-IBM PSUs; it would just be a recipe change.  However, I\u0027m not sure if you want an option that granular.\n\nIs changing the interface name inside EntityManager to something generic not possible/practical?  That might avoid the need for this build option.\n\nNote that if someone does specify a different D-Bus interface, the interface will need to provide the same property names for the current C++ code to work.",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58e0b89a_bd54e5ca",
        "filename": "meson.build",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-06-29T09:42:20Z",
      "side": 1,
      "message": "Agree Shawn,\n\nI\u0027m using the non-IBM PSUs, and I must change the meson.build for my supply_interface. Why we set the interface name directly from build option? Or any other better solution.",
      "parentUuid": "4588b482_5de63a3c",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "142ea7fd_aa54e511",
        "filename": "meson.build",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1000085
      },
      "writtenOn": "2021-07-01T23:27:14Z",
      "side": 1,
      "message": "I was kind of thinking ahead here.\n\nI originally had this change and https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-power/+/44456 in the same commit, but then split it into two commits as the other one depends on the changes to use libgpiod.\n\nI was thinking we could get both the interface name and the device driver name based on a passed in power supply type variable.",
      "parentUuid": "58e0b89a_bd54e5ca",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5304a054_44c3ef55",
        "filename": "meson.build",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2021-07-06T13:02:07Z",
      "side": 1,
      "message": "\u003e An alternative approach would be\n\nI have another alternative to consider - simply support any number of PSU specific interfaces without any build time configuration.  This lets you support systems with different power supplies.\n\n\u003e Is changing the interface name inside EntityManager to something generic not possible/practical?\n\nI think if IBMCFFPSConnector is already being used for non IBMCFFPS PSUs, the schema itself is already \"generic\" - from a functional point of view the name is not really all that important.  It could just stay as it is.\n\n\u003e I was thinking we could get both the interface name and the device driver name based on a passed in power supply type variable.\n\nYou could maintain a mapping between interface names and device driver names in a header file.  This is what entity-manager does:\n\nhttps://github.com/openbmc/entity-manager/blob/master/include/devices.hpp\n\nAgain, this approach lets you support multiple power supply types at the same time and requires no build time configuration.  win-win.",
      "parentUuid": "142ea7fd_aa54e511",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "949c9272_2e653fe7",
        "filename": "meson.build",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1000085
      },
      "writtenOn": "2021-07-01T23:41:36Z",
      "side": 1,
      "message": "Shawn, this ends up being SUPPLY_INTERFACE in config.h, which kind of sort of ... eliminates the PSInterface coding standards violation... I think.",
      "range": {
        "startLine": 99,
        "startChar": 5,
        "endLine": 99,
        "endChar": 21
      },
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "069ff7a3_1850718d",
        "filename": "phosphor-power-supply/psu_manager.cpp",
        "patchSetId": 1
      },
      "lineNbr": 16,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-06-29T09:42:20Z",
      "side": 1,
      "message": "Hi,\n\nWith the \"I2CBus\" and \"I2CAddress\", Must we configure the property name like that in https://github.com/openbmc/entity-manager/tree/master/configurations ?",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db9a1f70_ac5317c3",
        "filename": "phosphor-power-supply/psu_manager.cpp",
        "patchSetId": 1
      },
      "lineNbr": 16,
      "author": {
        "id": 1000085
      },
      "writtenOn": "2021-07-01T23:27:14Z",
      "side": 1,
      "message": "Yes.\n\nSo, for the IBM systems, the power supply information is coming from:\nhttps://github.com/openbmc/entity-manager/blob/master/configurations/Nisqually.json\nand \nhttps://github.com/openbmc/entity-manager/blob/master/configurations/Bellavista.json\n\nThose depend on the schema:\nhttps://github.com/openbmc/entity-manager/blob/master/schemas/IBM.json\n\nIt now looks even more apparently that something could maybe be a bit more generic for these as well.",
      "parentUuid": "069ff7a3_1850718d",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd1522d0_cb2c9d19",
        "filename": "phosphor-power-supply/psu_manager.cpp",
        "patchSetId": 1
      },
      "lineNbr": 16,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2021-07-06T13:02:07Z",
      "side": 1,
      "message": "\u003e It now looks even more apparently that something could maybe be a bit more generic for these as well.\n\nIf the schema works and is being used for someone besides IBM it is already general purpose - it doesn\u0027t matter what the name is or what file it is in.",
      "parentUuid": "db9a1f70_ac5317c3",
      "revId": "591ce9489fc43ac87e4911b9454a3e37566e5130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}